version: "3.9"

services:
  # ==========================
  # Development service
  # ==========================
  dev:
    build:
      context: .
      target: dev
    ports:
      - "4000:3000"          # host 4000 → container 3000
    volumes:
      - .:/app               # hot reload: map local code
      - /app/node_modules    # separate node_modules
    environment:
      NODE_ENV: development
    command: npm run dev

  # ==========================
  # Production service
  # ==========================
  web:
    build:
      context: .
      target: prod
    ports:
      - "5001:3000"          # host 5000 → container 3000 (different port!)
    environment:
      NODE_ENV: production

